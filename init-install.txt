# Load keyboard layout
loadkeys de

# Connect to WLAN (if not LAN)
iwctl --passphrase 22036727328731084417 station wlan0 connect WLAN-381152

# Check internet connection
ping -c4 www.google.de

# Sync time
timedatectl set-ntp true

# Reflector setup
reflector -c Germany -a 6 --sort rate --save /etc/pacman.d/mirrorlist

# Pacman sync
pacman -Syy

# Check partitions
lsblk

# Create partitions
gdisk /dev/sda
1: +300M ef00
2: +2G 8200
3: Rest 8300
Write: w, Confirm with Y

# Format partitions
mkfs.fat -F32 /dev/sda1
mkswap /dev/sda2
swapon /dev/sda2
mkfs.btrfs /dev/sda3

# Mount points for btrfs
mount /dev/sda3 /mnt
btrfs su cr /mnt/@

lsblk

mkfs.vfat /dev/nvm...1
mkswap /dev/nvm...2
swapon /dev/nvm...2
mkfs.ext4 /dev/nvm...3
mkfs.ext4 /dev/nvm...4
lsblk

mount /dev/nvm...3 /mnt
mkdir -p /mnt/{boot/efi,home}
mount /dev/nvm...1 /mnt/boot/efi
mount /dev/nvm...4 /mnt/home
lsblk

pacstrap /mnt base linux linux-firmware git vim amd-ucode

genfstab -U /mnt >> /mnt/etc/fstab

arch-chroot /mnt

git clone https://gitlab.com/stephan.raabe/arch-install-script.git
cd arch-install-script
chmod -x ...
vim /etc/mkinitcpio.conf
MODULES=(amdgpu)
mkinitcpio -p linux
exit
umount -R /mnt
reboot

